#include <iostream>
#include <map>
#include <vector>
#include <utility>
#include <queue>
using namespace std;

map<pair<int,int>, pair<int,int>> portals;
vector<vector<char>> board(129, vector<char>(121));
vector<vector<vector<int>>> visited(50, vector<vector<int>>(129, vector<int>(121)));
queue<pair<pair<int,int>, pair<int,int>>> nxt; // {steps, layer}, {x,y}
pair<int,int> start {55,116};
pair<int,int> final {124,71};

int nextlayer(int depth, int x, int y)
{
  if(x == 2 || x == 124 || y == 2 || y == 116) //Outer
  {
    if(depth == 0) //Kan ikke gå større end vi starter
    {
      return 0;
    }
    else
    {
      return -1; //Går -1 lag ned (op)
    }
  }
  else //Går 1 lag ned
  {
    if(depth == 49) //Max 100 lag dyb her
    {
      return 0;
    }
    else
    {
      return 1;
    }
  }
}

void all_portals()
{
  //AS
  portals[{53,84}] = {124,49};
  portals[{124,49}] = {53,84};
  //BM
  portals[{2,65}] = {69,84};
  portals[{69,84}] = {2,65};
  //CJ
  portals[{61,34}] = {124,55};
  portals[{124,55}] = {61,34};
  //CN
  portals[{92,47}] = {71,116};
  portals[{71,116}] = {92,47};
  //CT
  portals[{2,51}] = {87,84};
  portals[{87,84}] = {2,51};
  //DB
  portals[{75,34}] = {79,116};
  portals[{79,116}] = {75,34};
  //DF
  portals[{34,39}] = {59,116};
  portals[{59,116}] = {34,39};
  //DN
  portals[{34,53}] = {2,81};
  portals[{2,81}] = {34,53};
  //GM
  portals[{34,73}] = {124,65};
  portals[{124,65}] = {34,73};
  //GZ
  portals[{34,79}] = {124,75};
  portals[{124,75}] = {34,79};
  //IE
  portals[{67,34}] = {81,116};
  portals[{81,116}] = {67,34};
  //IK
  portals[{75,2}] = {34,61};
  portals[{34,61}] = {75,2};
  //IW
  portals[{39,2}] = {92,67};
  portals[{92,67}] = {39,2};
  //KE
  portals[{85,2}] = {59,84};
  portals[{59,84}] = {85,2};
  //KN
  portals[{87,34}] = {124,69};
  portals[{124,69}] = {87,34};
  //NK
  portals[{39,34}] = {49,116};
  portals[{49,116}] = {39,34};
  //NP
  portals[{51,2}] = {57,34};
  portals[{57,34}] = {51,2};
  //NW
  portals[{2,37}] = {92,57};
  portals[{92,57}] = {2,37};
  //PE
  portals[{49,34}] = {53,116};
  portals[{53,116}] = {49,34};
  //PM
  portals[{47,84}] = {37,116};
  portals[{37,116}] = {47,84};
  //QO
  portals[{69,2}] = {43,84};
  portals[{43,84}] = {69,2};
  //QW
  portals[{2,61}] = {92,75};
  portals[{92,75}] = {2,61};
  //RY
  portals[{2,45}] = {34,63};
  portals[{34,63}] = {2,45};
  //SJ
  portals[{53,2}] = {77,84};
  portals[{77,84}] = {53,2};
  //TE
  portals[{61,2}] = {34,45};
  portals[{34,45}] = {61,2};
  //VI
  portals[{92,41}] = {2,69};
  portals[{2,69}] = {92,41};
  //ZM
  portals[{124,39}] = {92,71};
  portals[{92,71}] = {124,39};
  return;
}


void move()
{
  int steps = nxt.front().first.first;
  int d = nxt.front().first.second;
  int x = nxt.front().second.first;
  int y = nxt.front().second.second;
  nxt.pop();
  if(board[x][y] != '.' || (visited[d][x][y] <= steps && steps > 0 && visited[d][x][y] != 0)) //Ikke muligt, eller bedre fundet
  {
    return;
  }
  //std::cout << "den har taget: " <<steps<<"skridt"<< '\n';
  if(portals.count({x,y})) //Starten på en portal
  {
    int dx = nextlayer(d,x,y);
    if(dx != 0)
    {
      //std::cout << "skubber lag " <<d+dx<< '\n';
      nxt.push({{steps+1,d+dx},portals[{x,y}]}); //Ændrer også lag nu
    }
  }
  visited[d][x][y] = steps;
  nxt.push({{steps+1,d}, {x+1,y}});
  nxt.push({{steps+1,d}, {x-1,y}});
  nxt.push({{steps+1,d}, {x,y+1}});
  nxt.push({{steps+1,d}, {x,y-1}});
  return;
}

int main()
{
  char tmp;
  for(int i=0;i<119;i++)
  {
    for(int o=0;o<128;o++)
    {
      scanf("%1c", &tmp);
      if(tmp == '.' || tmp == '#')
      {
        board[o][i] = tmp;
      }
    }
  }
  all_portals();
  nxt.push({{0,0},{start.first,start.second}});
  while(!nxt.empty())
  {
    move();
  }
  std::cout << "best result is: " <<visited[0][final.first][final.second]<< '\n';
  return 0;
}

/*

_______________________________________I___________N_S_______T_______Q_____I_________K_________________________________________
_______________________________________W___________P_J_______E_______O_____K_________E_________________________________________
__#####################################.###########.#.#######.#######.#####.#########.#######################################__
__#.#.#.....#...#.#...........#.#.#.....#.#.........#.......#...#.........#.#.....#...#.......#.........#.......#.......#...#__
__#.#.#####.###.#.###.#.#.###.#.#.#####.#.#####.#####.#####.#.#.###.#####.#.#.###.#.###.#.###.#.###.#######.###.###.#######.#__
__#...........#...#.#.#.#.#.........#...#.....#.....#...#...#.#.#.#...#...#.....#.#.....#...#.#.#.#...#.#...#.#.#.#.........#__
__###########.#.###.#######.###.###.###.#.#.###.###########.###.#.###.#########.#.#######.#####.#.#.#.#.#.###.###.#.###.###.#__
__#...#.#.#.......#...#.#...#...#.#...#.#.#.#.....#.#.....#...#...#...#.#.....#.#.#.......#.......#.#.#...#.#...#.#...#.#...#__
__###.#.#.###.###.#.###.#########.###.#.#.#####.###.#####.#.###.#.#.###.###.#.###.#.#########.###.#####.###.#.#.#.#.#######.#__
__#...#.#.....#...#.....#.#.....#...........#.#.........#.....#.#.#.#.....#.#.....#.............#.#.......#.#.#.#.#.......#.#__
__###.#.#########.###.###.#.#.#.#.###.#####.#.#.#.#######.#####.#.#.#.#.###.###.#########.#.#.#.#####.#####.###.#.#.#####.#.#__
__#.......#...............#.#.#...#.#.#...#...#.#.....#.....#.#.#.#.#.#...#.#.#.#...#...#.#.#.#.#.....#.......#.........#.#.#__
__#####.###########.#.#.###########.#####.###.###.###.#####.#.###.#.#.###.#.#.#.###.###.#.#######.#.#####.#####.#############__
__#.....#...#...#.#.#.#.#.#.#.........#.......#.....#.#.......#.#.#...#...#...#.#.....#...#.......#.....#.#.#.........#.....#__
__#####.###.###.#.###.###.#.#######.###.#######.#.#.#######.###.#.###.#.#####.#####.#.#.###.#####.#.###.#.#.#.#####.#####.###__
__#.#...........#.............................#.#.#.......#.#.....#...#.....#.....#.#.#.....#...#.#...#.........#.#...#.....#__
__#.#.#.#.#.###.#.#.#####.###.#.#.#####.#####.#.###.#######.#.###.#.#.###.#####.#.#.#.###.#.#.###.#######.#.#.###.#######.###__
__#.#.#.#.#...#.#.#.#.....#.#.#.#.#.......#...#...#...#.....#...#.#.#.#.#...#...#.#.#.....#.....#.#...#...#.#.........#.....#__
__#.#######.#######.###.###.###.#####.###.###.#.#####.#.#.#.#.#####.###.#.#######.#.#.#.#######.###.#####.###.#####.###.#.#.#__
__#.#...#...#.#.#.#...#.#.......#.....#...#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.......#.#.#.......#.........#.#...#.......#.#.#.#__
__#.#.#####.#.#.#.###############.###.#####.#.#.#.#.###.###.#.#####.#.#.#.###.#.#.#.#####.#.###.#.#####.#################.#.#__
__#...#.#...#.....#.#.#.....#.#.....#.#.......#.....#...#...#.....#.#.....#.#.#.#.#...#...#...#.#...#.....#...#...#.#.#.#.#.#__
__###.#.###.###.###.#.#.###.#.###.#######.###.###.#.#######.#.###########.#.#####.#.#########.###.#########.#####.#.#.#.###.#__
__#.#.....#.#...#.....#.#.#...........#.#.#.#...#.#.#...#...#.....#...#...#.....#.#...#.....#.#.#.#.......#.#.#...#...#.#...#__
__#.###.###.#.###.#.#####.#######.#.###.###.#.###.#.###.###.#.#.#.#.#####.###.###.#.#######.###.#####.#.###.#.#.###.###.###.#__
__#.............#.#.#.#.....#.....#.#.........#...#.#.......#.#.#.#.....#.#.....#.#...#...#.....#.#.#.#.....#.#.#...#...#...#__
__###.#.#####.#####.#.#.###################.###.#########.###.#####.#.#.#.#.###.#.###.#.###.#####.#.###.#####.#.###.###.###.#__
__#...#...#.#.#.......#.#...#.#...#.....#.#...#...#.#.......#.....#.#.#...#.#...#...#.......#.#.#.....#...#...#...#...#...#.#__
__#####.#.#.#.#####.#.#.###.#.#.#######.#.###.#.###.#.#####.#.###########.#.#.###.###.###.###.#.#.#####.#####.###.#.###.###.#__
__#...#.#...#.#.....#.#...#.................#.#.....#.#...#.#.....#...#...#.#.....#...#...#.#.#.....#.#...#.....#.....#.#...#__
__#.#####.#######.#.#.#.###.###########.###.#.###.#######.#.#.#####.#####.#.###.#.#.#.#.#.#.#.#.###.#.#.#####.###.#.###.###.#__
__#...#.#.#.#...#.#.#.#...#.#.....#.#.....#.....#...#...#...#...#.#.....#.#.#.#.#.#.#.#.#.........#.#...#.......#.#.......#.#__
__###.#.#.#.###.###.###.###.#####.#.#####.###.#####.###.###.#.###.#.#.###.#.#.#.#.###.###.###.#.#######.###.#########.#####.#__
__#.....#...#.#.#.#...#.#.#.#.....#.........#.#.....#.......#.#.....#.....#.#...#.#...#.....#.#.#.#...#...#...#.#.........#.#__
__###.#.#.#.#.#.#.###.#.#.#######.#####.#########.#######.###.#####.#######.###########.#####.###.#.###.###.###.###.###.###.#__
__#...#.#.#.#.#...........#...#...#____N_________P_______N___C_____I_______D___________K____#.#.#...#.......#.#...#.#.#.....#__
__###.###.###.#.#####.#####.#.###.#____K_________E_______P___J_____E_______B___________N____###.###.###.#####.#.#####.###.#.#__
NW....#.........#.#.#...#...#.#...#_________________________________________________________#...#.....#.....#.....#.#...#.#.#__
__###.#.#####.###.#.#######.#####.#_________________________________________________________#.#.###.#.#.#.#####.#.#.#.#####.#__
__#.....#.....#.#.#.#.#.#.#.#.#....DF_______________________________________________________#.#.#.#.#...#...#...#.#.....#....ZM
__#####.#.#####.#.#.#.#.#.#.#.###.#_________________________________________________________###.#.#.#####.#####.###.#######.#__
__#.....#.#...#.....#.....#.#.#...#_______________________________________________________VI....#...#.#...#.#.......#.#.#.#.#__
__#######.#.#.#.###.###.#.#.#.###.#_________________________________________________________#.#.#.###.#.###.###.###.#.#.#.#.#__
__#.#.#.....#...#.......#.........#_________________________________________________________#.#...#.#.............#.........#__
__#.#.#.###.#.#.#.#####.#####.#####_________________________________________________________#####.#.###.#.###.#.###.#########__
RY....#.#.#.#.#.#.#...#.#.#.#.#....TE_______________________________________________________#...#.#...#.#.#...#.#...#.......#__
__#.#####.#########.#####.#.###.#.#_________________________________________________________#.#.###.###########.#######.###.#__
__#...#.....#.....#.#.#.......#.#.#_______________________________________________________CN..#.........#.....#.#.#.....#...#__
__#.#.#.###.###.###.#.#.###.#####.#_________________________________________________________#####.###########.###.#.#.###.###__
__#.#...#.................#.......#_________________________________________________________#.#.#...#.#...#.#...#...#.#...#..AS
__#####################.#.#######.#_________________________________________________________#.#.#.###.#.###.#.#####.###.###.#__
CT....#.....#.......#...#...#.#.#.#_________________________________________________________#.........................#.....#__
__###.#.###.###.#.#.#######.#.#.###_________________________________________________________###.#.#############.#.#.###.#.###__
__#...#...#...#.#.#.#.#...#.#......DN_______________________________________________________#...#.#.......#.#...#.#.#...#.#.#__
__#.#####.###.#.#.###.###.###.#####_________________________________________________________#########.###.#.#####.#########.#__
__#.....#.#...#.#...........#.#...#_________________________________________________________#...#.#.....#...#...#...#...#.#..CJ
__###.###.###.#.#.#.###.#.#.#.###.#_________________________________________________________###.#.#####.#.#####.#.#####.#.#.#__
__#.......#.....#.#...#.#.#...#...#_______________________________________________________NW....#.....#.#.#.....#.#.........#__
__###############.#####.#######.###_________________________________________________________#.#.#.###.#.#.#####.#####.#####.#__
__#...........#.#...#.#...#.....#.#_________________________________________________________#.#...#.#...#...............#.#.#__
__#.###.#.#####.#####.#####.###.#.#_________________________________________________________#######.#####################.###__
QW..#...#...#...#.#.........#...#..IK_______________________________________________________#.............#.....#...........#__
__#.#.#######.#.#.#####.#####.###.#_________________________________________________________#.#####.#.###.#.#.###.#########.#__
__#.#.#.....#.#.#...#.......#...#..RY_______________________________________________________#.#...#.#...#...#...#.......#...#__
__#.#.#.#.###.###.#######.#####.#.#_________________________________________________________#.#######.###.#####.#####.###.###__
BM..#...#...................#.....#_________________________________________________________#.......#.#.....#.......#.#......GM
__#################.#.#.###########_________________________________________________________###.#.#############.#.#.#.#.###.#__
__#.#.............#.#.#...#.#.....#_______________________________________________________IW....#.#...#.#...#...#.#...#...#.#__
__#.#.#########.#.#.#######.###.###_________________________________________________________#######.###.#.###########.#######__
VI..#.......#...#.#.#.#...#.......#_________________________________________________________#...#.#.....#...#...#...#.#.#.#..KN
__#.#######.#####.###.#.###.#.#.###_________________________________________________________#.###.#.#####.###.#.###.###.#.#.#__
__#.......#.#.......#.....#.#.#...#_______________________________________________________ZM..#.....#.#.#...#.#.#............ZZ
__###.#####.#######.#.###.###.#.###_________________________________________________________#.#.#.###.#.#.###.#.#.#.#####.#.#__
__#.........#.#.#.......#.....#....GM_______________________________________________________#...#.............#...#.#.#.#.#.#__
__###########.#.###.#############.#_________________________________________________________#############.#.#########.#.#####__
__#.....#.........#...#.#.......#.#_______________________________________________________QW........#.#...#.#.........#...#..GZ
__#.#.#####.#####.#####.###.###.###_________________________________________________________#####.###.#####.###.#####.#.#.#.#__
__#.#...#.....#.#.#.....#...#.....#_________________________________________________________#...........#...#.....#...#.#...#__
__#.###.#.#.#.#.#.#####.#.#.###.#.#_________________________________________________________###.#####.###########.###.#.###.#__
__#...#...#.#.#.....#.#...#.#.#.#..GZ_______________________________________________________#.....#.#.#.....#.#.#.#...#...#.#__
__###.###.#.#.#.#.#.#.#.###.#.#.#.#_________________________________________________________#.#.#.#.#####.###.#.#.###.#.###.#__
DN......#.#.#.#.#.#.....#.#.#...#.#_________________________________________________________#.#.#.................#.......#.#__
__#.#.#.#.#######.#####.#.###.#.#.#________Q___P_____A_____K_________B_______S_________C____###.#.#.#.#####.#.#.###.#.#.#.###__
__#.#.#.#.#...........#...#...#.#.#________O___M_____S_____E_________M_______J_________T____#...#.#.#...#...#.#.#.#.#.#.#...#__
__#.#.#.#.###.#.#.#.###.#.###.#############.###.#####.#####.#########.#######.#########.#####.#.#.###.#.#.#.###.#.#.#.#.#.#.#__
__#.#.#.#...#.#.#.#...#.#.#.....#.#.#.#.....#...#.#.....#.........#.#.......#...#.....#.#.#...#.#...#.#.#.#.#.#...#.#.#.#.#.#__
__#.###.#####.#####.#####.###.###.#.#.###.###.###.#####.###.#######.###.#####.#.#####.#.#.#######.#.#####.###.#.###.###.#####__
__#...#.#...#...#.#.....#.#.....#.......#.#.#.....#.#...#.....#...........#.#.#.#...#.......#.....#.#...#...#.....#.#.....#.#__
__#.#.#.###.#.#.#.###.###.###.#######.###.#.#####.#.#.#.#.###.###.###.#####.###.#.#.#.###########.#.###.#.###.#.###.#.###.#.#__
__#.#.#.#.....#.#.#.#.#.#.#.....#.#.........#.......#.#.#.#.....#...#.#.#...#...#.#.....#.#.....#.#...#...#.#.#...#.#...#...#__
__#.#.#######.###.#.#.#.#.#.#.#.#.###.#.###.#.#########.###.###.###.###.#.#.#.###.#######.###.#.#.#.###.#.#.###.###.#.###.#.#__
__#.#...#.#.#.#.#.....#...#.#.#.#.....#.#.#.#...#...#...#...#.#.#.#.....#.#...#...#...........#.#.#.#...#.....#...#.#...#.#.#__
__###.#.#.#.#.#.###.#####.###.#####.###.#.#.###.###.###.#.#.#.###.#####.#.###.###.#.###.#.#######.#####.#.#.###.#######.#.#.#__
__#...#.#.........#...#...#.....#.....#.#.#.#...#.....#.#.#.#.......#...#...#.#...#...#.#.......#...#...#.#.#.#.....#...#.#.#__
__###.#.#.###.###########.###.#.#.#######.#.#.###.#.#.#.#.###.#.#######.###.#####.###.#.#########.#####.###.#.#.#.#.#######.#__
__#.#.#.#...#.........#.....#.#.#.#...#.....#.....#.#.#.#.....#.#...#...#...#.........#.#...#...#.#.#.....#.#...#.#.......#.#__
__#.#.#####.#.#.#####.###############.#####.#######.###.#######.#.###.#.#.#######.#.#.#.###.#.###.#.#.#.#.###.#.#.#.###.#####__
__#...#.#...#.#...#...#.....#.......#.........#.......#.....#.......#.#.#.......#.#.#.#.........#.#.#.#.#...#.#.#.#...#.....#__
__###.#.#.#####.#.#####.#.#####.#.#.#.#####.#####.#####.#.#####.#.#####.#.###########.#.###.#.###.#.#.###########.###.###.###__
__#.....#.#.....#.#...#.#...#.#.#.#.#.#.#.....#.....#...#.#.....#.#.....#.#...#...#.#.#...#.#...#.#.#.#...#.......#...#.....#__
__#.###.###.###.#####.###.###.###.#####.#.###.#####.###.#####.#.#####.###.#.###.###.###.#####.#####.###.#######.#.#######.###__
__#.#.#.#...#...#.........#.#...#.#.......#...#.....#...#...#.#.#.#.....#.........#.......#.#.#...#.#.....#.#...#.....#.....#__
__###.###################.#.#.###.#.#####.#.#######.###.###.###.#.###.###.#.###.###.#######.###.###.###.#.#.###.#.###.#####.#__
__#.........#.#.#.........#.#.#...#.#.....#.#.........#.......#.#.......#.#.#.#.#.....#.................#.....#.#.#.#.....#.#__
__#####.#####.#.#########.#.#.#.#.#####.###########.###.#######.#.#####.#.###.#####.#.###.#.#.#.#####.###########.#.#.#.###.#__
__#.#.#.....#.#.#.#...#.........#...#.#.......#.#...#...#.#...#.#.....#.#.........#.#...#.#.#.#.....#.......#.....#...#.#...#__
__#.#.###.###.#.#.###.#####.#.#.###.#.#.###.###.###.#.###.###.#.#####.#####.#.#.#######.#.#######.###.#.#####.###.#.#.#.###.#__
__#.......#.#.....#.#...#.#.#.#.#.#.#.....#.#.....#.#.....#.....#.......#...#.#.#.#.#.......#...#...#.#...#.#...#.#.#.#.#...#__
__#.#.###.#.###.###.###.#.#######.#.#.#######.#####.#.#.###.#.###.#.#####.#######.#.###.###.###.#######.###.###.#.###.#####.#__
__#.#.#.#...............#.....#.#.#.........#...#...#.#...#.#.#...#.....#.#...#...#.#.....#.......#...........#.#...#.#.....#__
__#####.#.###.#.#.#####.###.###.#.#######.###.#.#.###.#####.#####.#####.#.#.#####.#.###.#######.#.###.#.#.#.###.#.###.#.###.#__
__#.......#...#.#.#.....#...............#...#.#.#.#.....#.......#.#...#.#.....#.#.....#.....#.#.#.#.#.#.#.#.#.#.#.#...#...#.#__
__#.###.#####.#.#.###.#.#####.#######.#.###.#.#.#.#.###.#######.#.###.#####.###.#.###.#.#####.#####.#########.#.#####.###.#.#__
__#.#.......#.#.#.#...#.........#.#.#.#.#...#.#...#.#...#.#.....#.#.....#...#...#.#.#.........................#.#...#.#.#.#.#__
__#######.###.###.#####.#########.#.#.#.#.###.#######.###.#.###.#.#.###.#.###.#.#.#.#.###.###.#.###.#.#.#.#.#####.#.#.#.#####__
__#.......#...#.....#...#.............#...#.........#.....#.#...#...#...#.....#.#.#.#...#...#.#...#.#.#.#.#.......#.#.......#__
__###################################.###########.###.#.###.###########.#######.#.###########################################__
_____________________________________P___________N___P_A___D___________C_______D_I_____________________________________________
_____________________________________M___________K___E_A___F___________N_______B_E_____________________________________________

*/
